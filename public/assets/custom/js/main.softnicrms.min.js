!function(e){function t(t){e.get("orders/show/"+t,function(t){if(setTimeout(function(){hideLoader()},600),"error"==t.status)return swal("Error",t.msg,"error"),!1;e("#order_info").modal("show"),e("#order_info").find(".modal-content").html(t),fixPlugin()})}e.ajaxSetup({headers:{"X-CSRF-TOKEN":e('meta[name="csrf-token"]').attr("content")},statusCode:{401:function(){return window.location.reload(),!1}}}),softnicRms={newClientPage:{init:function(){e("#newClientForm").on("submit",function(t){t.preventDefault();var r=e(this);r.find('button[type="submit"]').prop("disabled",!0);var o=r.serialize()+"&addClient";e.post(r.attr("action"),o,function(e){var t=JSON.parse(e);"success"==t.status?window.location.replace("clients.php"):(swal("Error",t.msg,"error"),r.find('button[type="submit"]').prop("disabled",!1))})})}},newCategoryPage:{init:function(){e("#newCategoryForm").on("submit",function(t){t.preventDefault();var r=e(this);r.find('button[type="submit"]').prop("disabled",!0);var o=r.serialize()+"&addCategory";e.post(r.attr("action"),o,function(e){var t=JSON.parse(e);"success"==t.status?window.location.replace("categories.php"):(swal("Error",t.msg,"error"),r.find('button[type="submit"]').prop("disabled",!1))})})}},updateCategoryPage:{init:function(){e("#updateCategoryForm").on("submit",function(t){t.preventDefault();var r=e(this);r.find('button[type="submit"]').prop("disabled",!0);var o=r.serialize();delete o.category_id;var n=`/admin/category/update/${e("#category_id").val()}`;e.ajax({type:"PUT",url:n,data:o,dataType:"json",success:function(e){"success"==e.status?swal("Success",e.msg,"success"):swal("Error",e.msg,"error")},error:function(){swal("Error","An error occurred while processing the request.","error")},complete:function(){r.find('button[type="submit"]').prop("disabled",!1)}})})}},categoryPage:{init:function(){e(document).on("click",".removeRow",function(t){t.preventDefault();var r=e(this),o=r.attr("data-rowId");swal({title:"Are you sure?",text:"You will not be able to recover.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!0},function(){e.ajax({url:"/admin/category/delete/"+o,type:"DELETE",success:function(t){"success"==t.status?(r.parent().parent().css("background-color","red").hide("slow"),swal("Success",t.msg,"success"),e("#categoryList").load(window.location+" #categoryList")):swal("Error",t.msg,"error")}})})})}},waiterPage:{init:function(){e(document).on("click",".removeRow",function(t){t.preventDefault();var r=e(this),o=r.attr("data-rowId");swal({title:"Are you sure?",text:"You will not be able to recover.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!0},function(){e.ajax({url:"/admin/waiter/delete/"+o,type:"DELETE",success:function(t){"success"==t.status?(r.parent().parent().css("background-color","red").hide("slow"),swal("Success",t.msg,"success"),e("#categoryList").load(window.location+" #categoryList")):swal("Error",t.msg,"error")}})})})}},addItemPage:{init:function(){e("#addItemForm").on("submit",function(t){t.preventDefault();var r=e(this),o=new FormData(this);o.append("addItem",""),e.ajax({type:"POST",url:r.attr("action"),data:o,dataType:"json",contentType:!1,cache:!1,processData:!1,beforeSend:function(){r.find('button[type="submit"]').prop("disabled",!0)},success:function(e){"success"==e.status?window.location.replace("item_list.php"):swal("Error",e.msg,"error"),r.find('button[type="submit"]').prop("disabled",!1)}})})}},blockedCustomer:{init:function(){e(document).on("click",".unBlockBtn",function(t){var r=e(this),o=r.attr("blocked_id");e.post("/admin/unblock/customers",{blocked_id:o},function(e){var t=e;"success"==t.status?(r.parent().parent().css("background","red").fadeOut(),swal("Success",t.msg,"success")):swal("Error",t.msg,"error")})})}},itemListPage:{init:function(){e(".removeRow").on("click",function(t){t.preventDefault();var r=e(this),o={user_id:r.attr("data-rowId")};swal({title:"Are you sure?",text:"You will not be able to recover.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!0},function(){e.post("/user/delete",o,function(e){var t=e;"success"==t.status?(r.parent().parent().css("background-color","red").hide("slow"),swal("Success",t.msg,"success")):swal("Error",t.msg,"error")})})})}},deptListPage:{init:function(){e(".removeRow").on("click",function(t){t.preventDefault();var r=e(this),o={dept_id:r.attr("data-rowId")};swal({title:"Are you sure?",text:"You will not be able to recover.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!0},function(){e.post("/department/delete",o,function(e){var t=e;"success"==t.status?(r.parent().parent().css("background-color","red").hide("slow"),swal("Success",t.msg,"success")):swal("Error",t.msg,"error")})})})}},doctorListPage:{init:function(){e(".removeRow").on("click",function(t){t.preventDefault();var r=e(this),o={doctor:r.attr("data-rowId")};swal({title:"Are you sure?",text:"You will not be able to recover.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!0},function(){e.post("/doctor/delete",o,function(e){var t=e;"success"==t.status?(r.parent().parent().css("background-color","red").hide("slow"),swal("Success",t.msg,"success")):swal("Error",t.msg,"error")})})})}},editItemPage:{init:function(){e("#updateItemForm").on("submit",function(t){t.preventDefault();var r=e(this),o=new FormData(this);e.ajax({type:"POST",url:r.attr("action"),data:o,dataType:"json",contentType:!1,cache:!1,processData:!1,beforeSend:function(){r.find('button[type="submit"]').prop("disabled",!0)},success:function(e){"success"==e.status?(swal("Success",e.msg,"success"),setTimeout(function(){location.reload()},1e3)):swal("Error",e.msg,"error"),r.find('button[type="submit"]').prop("disabled",!1)}})}),e("#image").change(function(){if(this.files&&this.files[0]){var t=new FileReader;t.onload=function(t){e("#imagePreview").attr("src",t.target.result)},t.readAsDataURL(this.files[0])}})}},addTablePage:{init:function(){e("#addTableForm").on("submit",function(t){t.preventDefault();var r=e(this),o=r.serialize()+"&addTable";r.find('button[type="submit"]').prop("disabled",!0).text("Loading..."),e.post(r.attr("action"),o,function(e){var t=JSON.parse(e);"success"==t.status?window.location.replace("tables.php"):(swal("Error",t.msg,"error"),r.find('button[type="submit"]').prop("disabled",!1).text("Add Table"))})})}},tablesPage:{init:function(){}},ordersPage:{init:function(){var r=e("#order_info");e(document).on("click",".viewOrder",function(t){setTimeout(function(){hideLoader()},600),t.preventDefault();var o=e(this).attr("data-rowId");showLoader("Loading order..."),e.get("orders/show/"+o,function(e){if("error"==e.status)return swal("Error",e.msg,"error"),!1;r.modal("show"),r.find(".modal-content").html(e),fixPlugin()})}),e(document).on("submit","#discountForm",function(t){t.preventDefault();var r=e("#order_info"),o=e(this).serialize();showLoader("Updating discount..."),e.post("orders/discount",o,function(e){if(setTimeout(function(){hideLoader()},600),"error"==e.status)return swal("Error",e.msg,"error"),!1;r.modal("show"),r.find(".modal-content").html(e),fixPlugin()})}),e(document).on("click",".romoveDiscountFromOrder",function(t){t.preventDefault();var o=e(this).attr("data-rowId");showLoader("Removing discount..."),e.post("orders/discount/remove",{orderId:o},function(e){setTimeout(function(){hideLoader()},600);var t=e;if("error"==t.status)return swal("Error",t.msg,"error"),!1;r.modal("show"),r.find(".modal-content").html(t),fixPlugin()})}),e(document).on("click",".placeOrderBtn",function(r){r.preventDefault();var o=e(this).attr("data-rowId");e.post("orders/accept",{orderId:o},function(r){var n=r;if("success"==n.status){t(o);var s=n.order_id;e("#order_no_"+s).removeClass("blink_order"),e("#order_no_"+s).find(".bs-placeholder .filter-option").text("In Process"),e("#order_no_"+s).find(".bs-placeholder").parent().removeClass("filter_option_pending").addClass("filter_option_preparation"),fixPlugin(),hideLoader(),swal("Success",n.msg,"success")}else hideLoader(),swal("Error",n.msg,"error")})}),e(document).on("click",".completeOrder",function(t){t.preventDefault();var o=e(this),n=e("#pay_type :selected").val();if(""==n)return swal("Error","Please select payment type!","error"),!1;var s=o.attr("data-rowId"),i=o.attr("data-3rdparty"),a=!0,c=null;1==i&&""==(c=e("#order_info").find('input[name="total_amount"]').val())&&(a=!1,swal("Error","Order amount should not be empty!","error")),a&&(showLoader("Order completing, wait..."),e.post("orders/complete",{orderId:s,order_amount:c,pay_type:n},function(t){var o=t;"success"==o.status?(e.get("orders/show/"+s,function(e){if(setTimeout(function(){hideLoader()},600),"error"==e.status)return swal("Error",e.msg,"error"),!1;r.modal("show"),r.find(".modal-content").html(e),fixPlugin()}),r.find(".modal-content").html(t),e("#order_no_"+t.order_id).removeClass("blink_order"),e("#order_no_"+t.order_id).find(".bs-placeholder .filter-option").text("Completed"),e("#order_no_"+t.order_id).find(".bs-placeholder").parent().removeClass("filter_option_preparation").addClass("filter_option_delivered"),fixPlugin(),hideLoader(),swal("Success",o.msg,"success")):(hideLoader(),swal("Error",o.msg,"error"))}))}),e(document).on("click",".cancelOrderBtn",function(r){r.preventDefault();var o=e(this).attr("data-rowId");swal({title:"Are you sure?",text:"You will not be able to recover.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, cancel order!",closeOnConfirm:!0},function(){showLoader("Please wait..."),e.post("orders/cancel",{cancelOrder:"",orderId:o},function(r){var n=r;"success"==n.status?(t(o),e("#order_no_"+n.order_id).removeClass("blink_order"),e("#order_no_"+n.order_id).find(".bs-placeholder .filter-option").text("Cancelled"),e("#order_no_"+n.order_id).find(".bs-placeholder").parent().removeClass("filter_option_preparation").addClass("filter_option_cancelled"),fixPlugin(),hideLoader(),swal("Success",n.msg,"success")):(hideLoader(),swal("Error",n.msg,"error"))})})}),e(document).on("submit","#updateCartForm",function(t){t.preventDefault();var o=e(this);showLoader("Please wait..."),e.post("orders/item/update",o.serialize(),function(e){setTimeout(function(){hideLoader()},600);var t=e;if("error"==t.status)return swal("Error",t.msg,"error"),!1;r.modal("show"),r.find(".modal-content").html(t),fixPlugin()})}),e(document).on("click",".updateCustomerDetails",function(){e(this).select()}),e(document).on("blur",".updateCustomerDetails",function(t){t.preventDefault();var r=e(this),o=r.attr("name"),n=r.val(),s=e(document).find("#updateOrderId").val();e.post("orders/update/userinfo",{name:o,value:n,orderId:s},function(t){setTimeout(function(){hideLoader()},600);var r=t;if("error"==r.status)return swal("Error",r.msg,"error"),!1;e("#order_no_"+r.order_id).find("fullname"==o?".fullname":".phone").text(n)})}),e(document).on("click",".blockIpAddress",function(t){t.preventDefault();var r=e(this),o=r.attr("type"),n=e(document).find(".cancelOrderBtn").attr("data-rowid");e.post("orders/block/ip",{orderId:n,type:o},function(e){setTimeout(function(){hideLoader()},600);var t=e;if("error"==t.status)return swal("Error",t.msg,"error"),!1;r.removeClass("block"==o?"btn-danger":"btn-success").addClass("block"==o?"btn-success":"btn-danger").attr("type","block"==o?"unblock":"block").text("block"==o?"Unblock":"Block"),swal("Success",t.msg,"success")})}),e(document).on("click",".removeProductFromOrder",function(t){t.preventDefault();var o=e(this).attr("data-rowid");swal({title:"Are you sure?",text:"You will not be able to recover.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Yes, delete it!",closeOnConfirm:!0},function(){showLoader("Deleting item..."),e.ajax({url:"orders/remove/item",type:"POST",data:{item_id:o},success:function(e){if(setTimeout(function(){hideLoader()},600),"error"==e.status)return swal("Error",e.msg,"error"),!1;r.modal("show"),r.find(".modal-content").html(e),fixPlugin()}})})}),e(document).on("click","#addProToTbL",function(t){var r=e(document).find(".item_repeter_content").first().clone();e(".item_repeter_container").append(r),r.find(".select2-container").remove(),r.find("input").val(""),r.find('input[name="qty[]"]').val(1),r.find("button").removeAttr("id").addClass("remove_repeter_item"),r.find("button i").removeClass("fa-plus").addClass("fa-minus"),r.find("button").removeClass("btn-primary").addClass("btn-danger"),r.find(".action_name").text("Remove"),e(".select2").select2()}),e(document).on("click",".remove_repeter_item",function(t){e(this).parent().parent().parent().remove()}),e(document).on("submit","#adminAddonItemsForm",function(t){setTimeout(function(){hideLoader()},600),t.preventDefault();var o=e(this);showLoader("Please wait..."),e.post("orders/addon",o.serialize(),function(e){var t=e;if("error"==t.status)return swal("Error",t.msg,"error"),!1;r.modal("show"),r.find(".modal-content").html(t),fixPlugin()})}),e("#createNewOrderBtn").on("click",function(t){e("#modal_create_new_order").modal("show")}),e("#create_new_order_form").on("submit",function(t){var r=e(this);t.preventDefault(),e.post("orders/create",r.serialize(),function(e){var t=e;"success"==t.status?(swal("Success",t.msg,"success"),window.location.reload()):(hideLoader(),swal("Error",t.msg,"error"))})}),e(document).on("click",".sendWhatsappInvoice",function(t){t.preventDefault();let r=e('input[name="order_id"]').val();showLoader("Sending invoice on WhatsApp..."),e.get(`wpinvoice/${r}`,(e,t)=>{hideLoader(),e.error?swal("Error",e.message,"error"):swal("Success","Invoice sent successfully.","success")})}),e(document).on("click","#sendOrderInfoBtn",function(t){t.preventDefault();let r=e('input[name="order_id"]').val(),o=e("#waiter_id option:selected").val();if(""==o)return swal("Error","Please select a waiter!","error"),!1;showLoader("Sending order info..."),e.post("waiter/send",{order_id:r,waiter_id:o},(e,t)=>{hideLoader(),e.error?swal("Error",e.message,"error"):swal("Success","KOT sent successfully.","success")})})}},clientPageUser:{init:function(){e("#newTransactionBtn").on("click",function(t){e("#modal_new_transaction").modal("show")}),e("#new_transactin_form").on("submit",function(t){t.preventDefault();var r=e(this);r.find('button[type="submit"]').prop("disabled",!0);var o=r.serialize()+"&addNewTransaction=";e.post(r.attr("action"),o,function(e){var t=JSON.parse(e);"success"==t.status?location.reload(!1):(swal("Error",t.msg,"error"),r.find('button[type="submit"]').prop("disabled",!1))})})}},settingsPage:{init:function(){e("#updateSettingsForm").on("submit",function(t){t.preventDefault();var r=e(this);r.find('button[type="submit"]').prop("disabled",!0);var o=r.serialize()+"&updateSettings=";e.post(r.attr("action"),o,function(e){var t=JSON.parse(e);"success"==t.status?(swal("Success",t.msg,"success"),setTimeout(function(){location.reload(!1)},1e3)):(swal("Error",t.msg,"error"),r.find('button[type="submit"]').prop("disabled",!1))})})}}}}($);